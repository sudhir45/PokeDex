<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pokédex Top 50 — Stable</title>
<style>
  :root {
    --bg-light: linear-gradient(135deg, #f8fafc, #e0f2fe);
    --bg-dark: linear-gradient(135deg, #1e293b, #0f172a);
    --text-light: #222;
    --text-dark: #f1f5f9;
    --card-light: #fff;
    --card-dark: #334155;
    --modal-light: #fff;
    --modal-dark: #1e293b;
  }
  *{box-sizing:border-box}
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: var(--bg-light);
    margin: 0;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    color: var(--text-light);
    transition: background 0.3s, color 0.3s;
  }
  body.dark { background: var(--bg-dark); color: var(--text-dark); }
  h1 { font-weight: 700; margin-bottom: 12px; }
  .controls { display: flex; gap: 10px; margin-bottom: 16px; flex-wrap: wrap; align-items: center; }
  .controls input, .controls select, .controls button { padding: 8px 12px; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 0.95rem; background: var(--card-light); color: inherit; transition: background 0.3s, border-color 0.3s; }
  body.dark .controls input, body.dark .controls select, body.dark .controls button { background: var(--card-dark); border-color: #475569; }
  .pokedex-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 18px; width: 100%; max-width: 1400px; }
  .card { background: var(--card-light); border-radius: 14px; overflow: hidden; box-shadow: 0 6px 18px rgba(2,6,23,0.08); cursor: pointer; transition: transform .18s ease, box-shadow .18s ease, background .3s; display:flex; flex-direction:column; align-items:center; padding:14px; }
  body.dark .card { background: var(--card-dark); box-shadow: 0 6px 18px rgba(2,6,23,0.28); }
  .card:hover { transform: translateY(-6px); box-shadow: 0 14px 30px rgba(2,6,23,0.12); }
  .card img { width: 170px; height: 170px; object-fit: contain; image-rendering: pixelated; }
  .name { font-weight: 700; margin-top: 10px; text-align:center; text-transform: capitalize; }
  .types { display:flex; gap:6px; margin-top:8px; }
  .type { padding:4px 10px; border-radius:999px; font-size:0.85rem; color:#fff; font-weight:600; box-shadow: 0 3px 8px rgba(2,6,23,0.08); text-transform: capitalize; }
  /* Modal */
  .modal { display:none; position:fixed; inset:0; background: rgba(2,6,23,0.6); justify-content:center; align-items:center; z-index:1200; }
  .modal-content { background: var(--modal-light); border-radius:14px; max-width:820px; width:92%; padding:18px; box-shadow: 0 8px 30px rgba(2,6,23,0.18); animation: popup .26s ease; display:grid; grid-template-columns: 1fr 1fr; gap:12px; align-items:start; }
  body.dark .modal-content { background: var(--modal-dark); color: var(--text-dark); }
  @keyframes popup { from { transform: translateY(-12px); opacity:0 } to { transform: translateY(0); opacity:1 } }
  .modal-left { display:flex; flex-direction:column; align-items:center; }
  .modal-left img { width: 320px; height: 320px; object-fit: contain; animation: float 2.6s ease-in-out infinite; }
  @keyframes float { 0%,100% { transform: translateY(0) } 50% { transform: translateY(-10px) } }
  .modal-header { display:flex; justify-content:space-between; align-items:center; gap:8px; }
  .modal-header h2 { margin:0; text-transform: capitalize; }
  .close-btn { background:none; border:0; font-size:20px; cursor:pointer; color:inherit }
  .modal-right { padding:6px 4px; }
  .desc { font-size:0.95rem; color:inherit; margin-top:6px; line-height:1.3 }
  .abilities { margin-top:10px; font-size:0.95rem }
  .stats-grid { display:grid; grid-template-columns:1fr; gap:8px; margin-top:12px }
  .stat { display:flex; flex-direction:column; gap:6px }
  .stat-name { display:flex; justify-content:space-between; font-weight:600 }
  .stat-bar { background: rgba(0,0,0,0.06); height:12px; border-radius:8px; overflow:hidden }
  .stat-fill { height:100%; width:0; background: linear-gradient(90deg,#38bdf8,#60a5fa); transition: width .6s cubic-bezier(.2,.9,.2,1) }
  .meta { margin-top:10px; display:flex; gap:10px; flex-wrap:wrap; font-size:0.95rem }
  .meta span { background: rgba(0,0,0,0.04); padding:6px 10px; border-radius:8px }
  body.dark .meta span { background: rgba(255,255,255,0.04) }
  @media (max-width:800px){ .modal-content{ grid-template-columns:1fr; } .modal-left img{ width:240px; height:240px } }
</style>
</head>
<body>
<h1>Pokédex Top 50</h1>
<div class="controls">
  <input id="search" placeholder="Search Pokémon..."> 
  <select id="typeFilter"><option value="">All Types</option></select>
  <button id="darkToggle">Toggle Dark</button>
</div>
<div id="grid" class="pokedex-grid" aria-live="polite"></div>

<div id="modal" class="modal" onclick="if(event.target===this) closeModal()">
  <div class="modal-content" role="dialog" aria-modal="true">
    <div class="modal-left">
      <div class="modal-header" style="width:100%">
        <h2 id="modalName"></h2>
        <button class="close-btn" aria-label="Close" onclick="closeModal()">✕</button>
      </div>
      <img id="modalImage" src="" alt="Pokemon image">
      <div id="modalTypes" class="types" style="margin-top:10px"></div>
    </div>
    <div class="modal-right">
      <div id="modalDescription" class="desc"></div>
      <div id="modalAbilities" class="abilities"></div>
      <div id="modalStats" class="stats-grid"></div>
      <div id="modalMeta" class="meta"></div>
    </div>
  </div>
</div>

<script>
// Top 50 (by national dex ids) — adjustable
const top50 = [6,25,150,658,448,94,383,149,384,445,248,376,373,151,181,282,628,493,257,9,3,130,392,635,887,197,196,135,134,470,471,700,778,65,68,212,143,131,466,81,474,386,468,350,80,230,38,359,612,530];
const pokedex = [];
const typeColors = { normal:'#A8A77A', Grass:'#78C850', Poison:'#A040A0', Fire:'#F08030', Water:'#6890F0', Electric:'#F8D030', Ice:'#98D8D8', Fighting:'#C03028', Ground:'#E0C068', Flying:'#A890F0', Psychic:'#F85888', Bug:'#A8B820', Rock:'#B8A038', Ghost:'#705898', Dragon:'#7038F8', Dark:'#705848', Steel:'#B8B8D0', Fairy:'#EE99AC' };

// safe fetch wrapper
async function safeFetch(url){
  try{
    const res = await fetch(url);
    if(!res.ok) throw new Error('Fetch failed: '+res.status);
    return await res.json();
  }catch(err){ console.warn('fetch error', url, err); return null }
}

(async function load(){
  for(const id of top50){
    const data = await safeFetch(`https://pokeapi.co/api/v2/pokemon/${id}`);
    if(!data) continue; // skip if failed
    pokedex.push({
      id,
      name: data.name.charAt(0).toUpperCase()+data.name.slice(1),
      types: data.types.map(t=>t.type.name.charAt(0).toUpperCase()+t.type.name.slice(1)),
      stats: Object.fromEntries(data.stats.map(s=>[s.stat.name.toUpperCase(), s.base_stat])),
      height: data.height, // decimeters
      weight: data.weight, // hectograms
      base_experience: data.base_experience,
      spritePaths: {
        animated: `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/versions/generation-v/black-white/animated/${id}.gif`,
        artwork: `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/other/official-artwork/${id}.png`,
        sprite: `https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${id}.png`
      }
    });
  }
  populateTypeFilter();
  renderPokedex();
})();

function renderPokedex(){
  const grid = document.getElementById('grid'); grid.innerHTML = '';
  const q = (document.getElementById('search').value||'').toLowerCase();
  const type = document.getElementById('typeFilter').value;
  pokedex.filter(p => p.name.toLowerCase().includes(q) && (type===''||p.types.includes(type))).forEach(p => {
    const card = document.createElement('div'); card.className = 'card';
    const img = document.createElement('img'); img.alt = p.name;
    img.src = p.spritePaths.animated;
    img.onerror = ()=>{ img.onerror=null; img.src = p.spritePaths.artwork; }
    const name = document.createElement('div'); name.className='name'; name.textContent = p.name;
    const types = document.createElement('div'); types.className='types'; types.innerHTML = p.types.map(t=>`<span class="type" style="background:${typeColors[t]||'#888'}">${t}</span>`).join('');
    card.appendChild(img); card.appendChild(name); card.appendChild(types);
    card.addEventListener('click', ()=>openModal(p));
    grid.appendChild(card);
  });
}

async function openModal(p){
  document.getElementById('modalName').textContent = p.name;
  const imgEl = document.getElementById('modalImage');
  // try animated -> artwork -> sprite
  imgEl.src = p.spritePaths.animated;
  imgEl.onerror = ()=>{ imgEl.onerror=null; imgEl.src = p.spritePaths.artwork; imgEl.onerror = ()=>{ imgEl.onerror=null; imgEl.src = p.spritePaths.sprite; }};

  document.getElementById('modalTypes').innerHTML = p.types.map(t=>`<span class="type" style="background:${typeColors[t]||'#888'}">${t}</span>`).join('');

  // species description (safe)
  const species = await safeFetch(`https://pokeapi.co/api/v2/pokemon-species/${p.id}`);
  let description = 'Description not available.';
  if(species && Array.isArray(species.flavor_text_entries)){
    const en = species.flavor_text_entries.find(e=>e.language && e.language.name==='en');
    const any = species.flavor_text_entries[0];
    const entry = en || any;
    if(entry && entry.flavor_text) description = entry.flavor_text.replace(//g,' ');
  }
  document.getElementById('modalDescription').textContent = description;

  // abilities and latest stats from API (safe)
  const data = await safeFetch(`https://pokeapi.co/api/v2/pokemon/${p.id}`);
  let abilities = '—';
  if(data && Array.isArray(data.abilities)) abilities = data.abilities.map(a=>a.ability.name).join(', ');
  document.getElementById('modalAbilities').innerHTML = `<strong>Abilities:</strong> ${abilities}`;

  // stats grid
  const statsHtml = Object.entries(p.stats).map(([k,v])=>{
    return `<div class="stat"><div class="stat-name"><span>${k.replace(/_/g,' ')}</span><span>${v}</span></div><div class="stat-bar"><div class="stat-fill" data-value="${v}"></div></div></div>`
  }).join('');
  document.getElementById('modalStats').innerHTML = statsHtml;

  // meta
  document.getElementById('modalMeta').innerHTML = `<span><strong>Height</strong>: ${p.height/10} m</span><span><strong>Weight</strong>: ${p.weight/10} kg</span><span><strong>Base XP</strong>: ${p.base_experience}</span><span><strong>BST</strong>: ${Object.values(p.stats).reduce((a,b)=>a+b,0)}</span>`;

  // open modal and animate stat bars
  document.getElementById('modal').style.display = 'flex';
  setTimeout(()=>{ document.querySelectorAll('.stat-fill').forEach(s => { const v = Number(s.dataset.value) || 0; s.style.width = Math.min(100, (v/150*100)) + '%'; }) }, 60);
}

function closeModal(){ document.getElementById('modal').style.display = 'none'; }

function populateTypeFilter(){
  const select = document.getElementById('typeFilter'); select.innerHTML = '<option value="">All Types</option>';
  const types = [...new Set(pokedex.flatMap(p=>p.types))].sort();
  types.forEach(t=>{ const opt = document.createElement('option'); opt.value = t; opt.textContent = t; select.appendChild(opt); });
}

// events
document.getElementById('search').addEventListener('input', renderPokedex);
document.getElementById('typeFilter').addEventListener('change', renderPokedex);
document.getElementById('darkToggle').addEventListener('click', ()=>document.body.classList.toggle('dark'));

</script>
</body>
</html>



